{{- /* Custom CSS for steipete.me inspired design */ -}}
<style>
.entry-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  margin-top: 2px;
}

.tag-chip {
  display: inline-block;
  padding: 4px 8px;
  font-size: 12px;
  font-weight: 500;
  color: var(--secondary);
  background: var(--tertiary);
  border-radius: 12px;
  text-decoration: none;
  transition: all 0.2s ease;
  border: 1px solid var(--border);
  position: relative;
  z-index: 10;
}

.tag-chip:hover {
  background: var(--primary);
  color: var(--theme);
  transform: translateY(-1px);
}

.dark .tag-chip {
  background: var(--tertiary);
  color: var(--primary);
}

.dark .tag-chip:hover {
  background: var(--primary);
  color: var(--theme);
}

/* Tag cloud styling for /tags/ page */
.tags-cloud {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 20px;
}

.tag-cloud-item {
  display: inline-flex;
  align-items: center;
  padding: 8px 12px;
  background: var(--entry);
  border: 1px solid var(--border);
  border-radius: 16px;
  text-decoration: none;
  transition: all 0.2s ease;
  color: var(--primary);
}

.tag-cloud-item:hover {
  background: var(--primary);
  color: var(--theme);
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.tag-name {
  font-weight: 500;
  margin-right: 6px;
}

.tag-count {
  font-size: 12px;
  background: var(--tertiary);
  color: var(--secondary);
  padding: 2px 6px;
  border-radius: 8px;
  font-weight: 600;
}

.tag-cloud-item:hover .tag-count {
  background: var(--theme);
  color: var(--primary);
}

.dark .tag-cloud-item {
  background: var(--entry);
  color: var(--primary);
}

.dark .tag-cloud-item:hover {
  background: var(--primary);
  color: var(--theme);
}

/* Reading Progress Bar */
.reading-progress {
  position: fixed;
  top: 0;
  left: 0;
  width: 0%;
  height: 3px;
  background: linear-gradient(90deg, #3b82f6, #06b6d4);
  z-index: 1000;
  transition: width 0.1s ease;
}

/* Enhanced Typography */
:root {
  --content-max-width: 720px;
  --line-height-base: 1.7;
  --font-size-base: 16px;
}

.post-content {
  max-width: var(--content-max-width);
  margin: 0 auto;
  line-height: var(--line-height-base);
  font-size: var(--font-size-base);
}

.post-content h1,
.post-content h2,
.post-content h3,
.post-content h4,
.post-content h5,
.post-content h6 {
  margin-top: 2.5rem;
  margin-bottom: 1rem;
  font-weight: 600;
  line-height: 1.3;
}

.post-content h1 { font-size: 2.25rem; }
.post-content h2 { font-size: 1.875rem; }
.post-content h3 { font-size: 1.5rem; }
.post-content h4 { font-size: 1.25rem; }

.post-content p {
  margin-bottom: 1.5rem;
}

.post-content blockquote {
  border-left: 4px solid var(--tertiary);
  padding-left: 1.5rem;
  margin: 2rem 0;
  font-style: italic;
  color: var(--secondary);
}

/* Enhanced Header Anchor Links */
.post-content h1:hover .anchor,
.post-content h2:hover .anchor,
.post-content h3:hover .anchor,
.post-content h4:hover .anchor,
.post-content h5:hover .anchor,
.post-content h6:hover .anchor {
  opacity: 1;
}

.anchor {
  opacity: 0;
  transition: opacity 0.2s ease;
  color: var(--tertiary);
  text-decoration: none;
  margin-left: 0.5rem;
}

.anchor:hover {
  color: var(--primary);
}

/* Improved Code Blocks */
.post-content pre {
  margin: 2rem 0;
  border-radius: 8px;
  border: 1px solid var(--border);
}

.post-content code {
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', 'Consolas', monospace;
  font-size: 0.875rem;
}

/* Enhanced Navigation */
.header nav {
  display: flex;
  align-items: center;
  gap: 2rem;
}

.header nav a {
  font-weight: 500;
  color: var(--primary);
  text-decoration: none;
  transition: color 0.2s ease;
  position: relative;
}

.header nav a:hover {
  color: var(--tertiary);
}

.header nav a.active::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--primary);
  border-radius: 1px;
}

/* Reduce vertical spacing between posts */
.post-entry {
  margin-bottom: calc(var(--gap) * 0.5) !important;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.post-entry:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

/* Post Navigation */
.post-nav-item {
  transition: all 0.2s ease;
}

.post-nav-item:hover {
  transform: translateY(-1px);
}

/* Enhanced system dark mode support */
@media (prefers-color-scheme: dark) {
  :root {
    --theme: rgb(29, 30, 32);
    --entry: rgb(46, 46, 51);
    --primary: rgb(218, 218, 219);
    --secondary: rgb(155, 156, 157);
    --tertiary: rgb(65, 66, 68);
    --content: rgb(196, 196, 197);
    --code-block-bg: rgb(46, 46, 51);
    --code-bg: rgb(55, 56, 62);
    --border: rgb(51, 51, 51);
  }

  .list {
    background: var(--theme);
  }

  .tag-chip {
    background: var(--tertiary);
    color: var(--primary);
  }

  .tag-chip:hover {
    background: var(--primary);
    color: var(--theme);
  }

  .tag-cloud-item {
    background: var(--entry);
    color: var(--primary);
  }

  .tag-cloud-item:hover {
    background: var(--primary);
    color: var(--theme);
  }

  .post-entry:hover {
    box-shadow: 0 8px 25px rgba(255,255,255,0.05);
  }
}
</style>

{{- /* Reading Progress Bar and Keyboard Navigation JavaScript */ -}}
<script>
// Reading Progress Bar
document.addEventListener('DOMContentLoaded', function() {
  // Only add progress bar on single post pages
  if (document.querySelector('.post-content')) {
    const progressBar = document.createElement('div');
    progressBar.className = 'reading-progress';
    document.body.appendChild(progressBar);

    function updateProgress() {
      const scrollTop = window.pageYOffset;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = (scrollTop / docHeight) * 100;
      progressBar.style.width = Math.min(progress, 100) + '%';
    }

    window.addEventListener('scroll', updateProgress);
    updateProgress(); // Initial call
  }

  // Keyboard Navigation (j/k for next/previous posts)
  const prevLink = document.querySelector('.paginav .prev');
  const nextLink = document.querySelector('.paginav .next');

  document.addEventListener('keydown', function(e) {
    // Only activate on single post pages and when not typing in inputs
    if (document.querySelector('.post-content') && 
        !['INPUT', 'TEXTAREA'].includes(e.target.tagName)) {
      switch(e.key.toLowerCase()) {
        case 'j':
          if (nextLink) {
            window.location.href = nextLink.href;
          }
          break;
        case 'k':
          if (prevLink) {
            window.location.href = prevLink.href;
          }
          break;
      }
    }
  });

  // Enhanced anchor link behavior
  document.querySelectorAll('.post-content h1, .post-content h2, .post-content h3, .post-content h4, .post-content h5, .post-content h6').forEach(heading => {
    const id = heading.getAttribute('id');
    if (id) {
      const anchor = document.createElement('a');
      anchor.href = '#' + id;
      anchor.className = 'anchor';
      anchor.innerHTML = '#';
      anchor.title = 'Link to this heading';
      heading.appendChild(anchor);
    }
  });
});
</script>